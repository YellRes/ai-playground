# 环境配置说明

## 关于 DeepSeek API 和 OpenAI 兼容性

### ❓ 为什么代码中使用 `langchain_openai`？

**不用担心**！这是正确的做法：
- DeepSeek 提供了**与 OpenAI 兼容的 API 接口**
- 使用 `ChatOpenAI` 类，只需将 `openai_api_base` 改为 `https://api.deepseek.com`
- **您只需要 DeepSeek API Key**，不需要 OpenAI API Key

这就像使用同一个手机应用连接不同的服务器，只需要更改服务器地址即可。

## API 密钥配置

本项目需要 DeepSeek API 密钥才能运行。

### 步骤 1：获取 DeepSeek API 密钥

1. 访问 [DeepSeek 平台](https://platform.deepseek.com/)
2. 注册账号并登录
3. 在控制台中创建 API 密钥

### 步骤 2：创建环境配置文件

在项目根目录（`langchain/financial-statements/`）下创建 `.env` 文件：

```bash
# .env 文件内容
DEEPSEEK_API_KEY=your_actual_api_key_here
```

**注意**：请将 `your_actual_api_key_here` 替换为您实际的 DeepSeek API 密钥。

### 步骤 3：验证配置

**推荐：先运行测试脚本**

```bash
# 进入项目目录
cd langchain/financial-statements

# 运行 API 测试脚本
python test_api.py
```

测试脚本会：
- ✅ 检查环境变量是否正确配置
- ✅ 测试 DeepSeek Chat API 是否可用
- ⚠️  测试 Embeddings API（可能不支持）

**然后运行主程序：**

```bash
# 运行基础示例
python index.py

# 运行 PDF 分析示例（需要 Embeddings 支持）
python index.py pdf

# 运行交互式模式
python index.py interactive
```

## 常见问题

### 1. 认证失败（Authentication Error）

如果看到类似以下错误：
```
openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Authentication Fails...'}}
```

**解决方法**：
- 检查 `.env` 文件是否存在
- 检查 `DEEPSEEK_API_KEY` 是否正确设置
- 确认 API 密钥是否有效且未过期

### 2. 导入错误（Import Error）

如果看到模块导入错误，请确保已安装所有依赖：

```bash
pip install -r requirements.txt
```

### 3. 编码错误（Unicode Error）

如果在 Windows 上遇到编码问题，代码已经自动处理。如果仍有问题，可以：
- 使用 Windows Terminal 或 PowerShell
- 设置控制台代码页：`chcp 65001`

## 项目结构

```
financial-statements/
├── index.py              # 主程序文件
├── requirements.txt      # 依赖包列表
├── .env                  # 环境配置文件（需要手动创建）
├── 环境配置说明.md      # 本文件
└── 600006_20250830_WOQW.pdf  # 示例财务报表
```

## 联系支持

如有问题，请检查：
1. [DeepSeek 官方文档](https://platform.deepseek.com/docs)
2. [LangChain 文档](https://python.langchain.com/)
3. [LangGraph 文档](https://langchain-ai.github.io/langgraph/)

